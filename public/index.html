<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="%PUBLIC_URL%/favicon.ico">
    <title>React App</title>
  </head>
  <body>
    <p>We left off yesterday preparing for our first deployment of our application. We&#39;re ready to deploy our application. Now the question is <em>where</em> and <em>what</em> are we going to deploy?</p>
<p>Let&#39;s explore...</p>
<h2 id="what">What</h2>
<p>While deploying a single page application has it&#39;s own intricasies, it&#39;s similar to deploying a non-single page application. What the end-user&#39;s browser requests all need to be available for the browser to request. This means all javascript files, any custom fonts, images, svg, stylesheets, etc. that we use in our application need to be available on a publicly available server.</p>
<p>Webpack takes care of building and packaging our entire application for what we&#39;ll need to give the server to send to our clients. This <em>includes</em> any client-side tokens and our production configuration (which we put together yesterday). </p>
<p>This means we only need to send the contents of the distribution directory webpack put together. In our case, this directory is the <code>build/</code> directory. We don&#39;t need to send anything else in our project to a remote server. </p>
<p>Let&#39;s use our build system to generate a list of production files we&#39;ll want to host. We can run the <code>npm run build</code> command to generate these files in the <code>build/</code> directory:</p>
<pre><code class="lang-bash">npm run build
</code></pre>
<p><img class="wide" src="/assets/images/series/30-days-of-react/day-28/npm-build.jpg" /></p>
<h2 id="where">Where</h2>
<p>These days we have many options for hosting client-side applications. We&#39;ll look at a few options for hosting our application today. Each of the following hosting services have their benefits and drawbacks, which we&#39;ll briefly discuss before we actually make a deployment.</p>
<p>There are two possible ways for us to deploy our application. If we are working with a back-end application, we can use the back-end server to host our public application files. For instance, if we were building a rails application, we can send the client-side application directly to the <code>public/</code> folder of the rails application. </p>
<p>This has the benefit of providing additional security in our application as we can verify a request from a client-side application made to the backend to have been generated by the server-side code. One drawback, however is that it can hog network bandwidth to send static files and potentially suck up resources from other clients. </p>
<p>In this section, we&#39;ll work on hosting our client-side only application, which is the second way we can deploy our application. This means we can run/use a server which is specifically designed for hosting static files separate from the back-end server. </p>
<p>We&#39;ll focus on the second method where we are using other services to deploy our client-side application. That is, we&#39;ll skip building a back-end and upload our static files to one (or more) of the (non-exhaustive) list of hosting services. </p>
<ul>
<li><a href="https://surge.sh/">surge.sh</a></li>
<li><a href="https://pages.github.com/">github pages</a></li>
<li><a href="https://www.heroku.com/">heroku</a></li>
<li><a href="https://aws.amazon.com/s3/">AWS S3</a></li>
<li><a href="https://getforge.com/">Forge</a></li>
<li><a href="https://www.bitballoon.com/">BitBalloon</a></li>
<li><a href="https://www.pancake.io/">Pancake</a></li>
<li>... More</li>
</ul>
<p>We&#39;ll explore a few of these options together. </p>
<h2 id="surge-sh">surge.sh</h2>
<p><img class="wide" src="/assets/images/series/30-days-of-react/day-28/surge.jpg" /></p>
<p><a href="https://surge.sh/">surge.sh</a> is arguably one of the easiest hosting providers to host our static site with. They provide a way for us to easily and repeatable methods for hosting our sites. </p>
<p>Let&#39;s deploy our application to surge. First, we&#39;ll need to install the <code>surge</code> command-line tool. We&#39;ll use <code>npm</code>, like so:</p>
<pre><code class="lang-bash">npm install --global surge
</code></pre>
<p>With the <code>surge</code> tool installed, we can run surge in our local directory and point it to the <code>build/</code> directory to tell it to upload the generated files in the <code>build/</code> directory.</p>
<pre><code class="lang-bash">surge -p build
</code></pre>
<p>The surge tool will run and it will upload all of our files to a domain specified by the output of the tool. In the case of the previous run, this uploads our files to the url of <a href="http://hateful-impulse.surge.sh/">hateful-impulse.surge.sh</a> (or the SSL version at <a href="https://hateful-impulse.surge.sh/">https://hateful-impulse.surge.sh/</a>)</p>
<p><img class="wide" src="/assets/images/series/30-days-of-react/day-28/surge-deploy.jpg" /></p>
<p>For more information on <code>surge</code>, check out their documentation at <a href="https://surge.sh/help/">https://surge.sh/help/</a>.</p>
<h2 id="github-pages">Github pages</h2>
<p><img class="wide" src="/assets/images/series/30-days-of-react/day-28/github-pages.jpg" /></p>
<p><a href="https://pages.github.com/">github pages</a> is another easy service to deploy our static files to. It&#39;s dependent upon using github to host our git files, but is another easy-to-use hosting environment for single page applications. </p>
<p>We&#39;ll need to start by creating our github pages repository on github. With an active account, we can visit the <a href="https://github.com/new">github.com/new</a> site and create a repository. </p>
<p><img class="wide" src="/assets/images/series/30-days-of-react/day-28/github-repo.jpg" /></p>
<p>With this repo, it will redirect us to the repo url. Let&#39;s click on the <code>clone or download</code> button and find the github git url. Let&#39;s copy and paste this to our clipboard and head to our terminal.</p>
<p><img class="wide" src="/assets/images/series/30-days-of-react/day-28/github-url.jpg" /></p>
<p>In our terminal, let&#39;s add this as a remote origin for our git repo. </p>
<p>Since we haven&#39;t created this as a git repo yet, let&#39;s initialize the git repo:</p>
<pre><code class="lang-bash">git init
git add -A .
git commit -am <span class="hljs-string">"Initial commit"</span>
</code></pre>
<p>In the root directory of our application, let&#39;s add the remote with the following command:</p>
<pre><code class="lang-bash">git remote add github [your git url here]
<span class="hljs-comment"># From the demo, this will be:</span>
<span class="hljs-comment"># git remote add origin git@github.com:auser/30-days-of-react-demo.git</span>
</code></pre>
<p>Next, we&#39;ll need to move to a branch called <code>gh-pages</code> as github deploys from this branch. We can easily do this by checking out in a new branch using git. Let&#39;s also run the generator and tell git that the <code>build/</code> directory should be considered the root of our app:</p>
<pre><code class="lang-bash">npm run build
git checkout -B gh-pages
git add <span class="hljs-_">-f</span> build
git commit -am <span class="hljs-string">"Rebuild website"</span>
git filter-branch <span class="hljs-_">-f</span> --prune-empty --subdirectory-filter build
git checkout -
</code></pre>
<p><img class="wide" src="/assets/images/series/30-days-of-react/day-28/git-branch.jpg" /></p>
<p>Since github pages does not serve directly from the root, but instead the build folder, we&#39;ll need to add a configuration to our <code>package.json</code> by setting the <code>homepage</code> key to the <code>package.json</code> file with our github url. Let&#39;s open the <code>package.json</code> file and add the &quot;homepage&quot; key:</p>
<pre><code class="lang-javascript">{
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"30days"</span>,
  <span class="hljs-string">"version"</span>: <span class="hljs-string">"0.0.1"</span>,
  <span class="hljs-string">"private"</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-string">"homepage"</span>: <span class="hljs-string">"http://auser.github.io/30-days-of-react-demo"</span>,
  <span class="hljs-comment">// ...</span>
}
</code></pre>
<blockquote>
<h2 id="hint">Hint</h2>
<p>We can modify json files by using the <a href="https://stedolan.github.io/jq/">jq</a> tool. If you don&#39;t have this installed, get it... get it now... It&#39;s invaluable</p>
<p>To change the <code>package.json</code> file from the command-line, we can use jq, like so:</p>
<pre><code class="lang-bash">jq <span class="hljs-string">'.homepage = \
    "http://auser.github.io/30-days-of-react-demo"'</span> \
    &gt; package.json
</code></pre>
</blockquote>
<p>With our pages built, we can generate our application using <code>npm run build</code> and push to github from our local <code>build/</code> directory.</p>
<pre><code class="lang-bash">git push <span class="hljs-_">-f</span> github gh-pages
</code></pre>
<p>Now we can visit our site at the repo pages url. For instance, the demo site is: <a href="https://auser.github.io/30-days-of-react-demo/#">https://auser.github.io/30-days-of-react-demo</a>.</p>
<blockquote>
<h2 id="future-deployments">Future deployments</h2>
<p>We&#39;ll need to add this work to a deployment script, so every time we want to release a new version of the site. We&#39;ll do more of this tomorrow. To release to github, we&#39;ll have to use the following script:</p>
<pre><code class="lang-bash"><span class="hljs-meta">#!/usr/bin/env bash</span>
git checkout -B gh-pages
git add <span class="hljs-_">-f</span> build
git commit -am <span class="hljs-string">"Rebuild website"</span>
git filter-branch <span class="hljs-_">-f</span> --prune-empty --subdirectory-filter build
git push <span class="hljs-_">-f</span> origin gh-pages
git checkout -
</code></pre>
</blockquote>
<p>For more information on github pages, check out their documentation at <a href="https://help.github.com/categories/github-pages-basics/">https://help.github.com/categories/github-pages-basics/</a>.</p>
<h2 id="heroku">Heroku</h2>
<p><img class="wide" src="/assets/images/series/30-days-of-react/day-28/heroku.jpg" /></p>
<p><a href="https://www.heroku.com/">Heroku</a> is a very cool hosting service that allows us to host both static and non-static websites. We might want to deploy a static site to heroku as we may want to move to a dynamic backend at some point, are already comfortable with deploying to heroku, etc. </p>
<p>To deploy our site to heroku, we&#39;ll need an account. We can get one by visiting <a href="https://signup.heroku.com/">https://signup.heroku.com/</a> to sign up for one. </p>
<p>We&#39;ll also need the <a href="https://devcenter.heroku.com/articles/heroku-command-line">heroku toolbet</a> as we&#39;ll be using the <code>heroku</code> command-line tool. </p>
<p>Finally, we&#39;ll need to run <code>heroku login</code> to set up credentials for our application:</p>
<pre><code class="lang-bash">heroku login
</code></pre>
<p><img class="wide" src="/assets/images/series/30-days-of-react/day-28/heroku-login.jpg" /></p>
<p>Next, we&#39;ll need to tell the <code>heroku</code> command-line that we have a heroku app. We can do this by calling <code>heroku apps:create</code> from the command-line in our project root:</p>
<pre><code class="lang-bash">heroku apps:create
<span class="hljs-comment"># or with a name</span>
heroku apps:create thirty-days-of-react-demo
</code></pre>
<p><img class="wide" src="/assets/images/series/30-days-of-react/day-28/heroku-create.jpg" /></p>
<p>Heroku knows how to run our application thanks to <a href="https://devcenter.heroku.com/articles/buildpacks">buildpacks</a>. We&#39;ll need to tell heroku we have a static-file buildpack so it knows to serve our application as a static file/spa. </p>
<p>We&#39;ll need to install the static-files plugin for heroku. This can be easiy install using the <code>heroku</code> tool:</p>
<pre><code class="lang-bash">heroku plugins:install heroku-cli-static
</code></pre>
<p><img class="wide" src="/assets/images/series/30-days-of-react/day-28/heroku-plugin.jpg" /></p>
<p>We can add the static file buildpack with the following command:</p>
<pre><code class="lang-bash">heroku buildpacks:<span class="hljs-built_in">set</span> https://github.com/hone/heroku-buildpack-static
</code></pre>
<p>For any configuration updates, we&#39;ll need to run the <code>static:init</code> command from heroku to generate the necessary <code>static.json</code> file:</p>
<pre><code class="lang-bash">heroku static:init
</code></pre>
<p><img class="wide" src="/assets/images/series/30-days-of-react/day-28/heroku-static-init.jpg" /></p>
<p>Now we can deploy our static site to heroku using the <code>git</code> workflow:</p>
<pre><code class="lang-bash">git push heroku master
<span class="hljs-comment"># or from a branch, such as the heroku branch</span>
git push heroku heroku:master
</code></pre>
<p>We&#39;ve deployed to only three of the hosting providers from the list above. There are many more options for deploying our application, however this is a pretty good start. </p>
<p>When we deploy our application, we will want to make sure everything is working before we actually send out the application to the world. Tomorrow we&#39;ll work on integrating a Continuous integration (CI, for short) server to run our tests before we deploy.</p>

  </body>
</html>
